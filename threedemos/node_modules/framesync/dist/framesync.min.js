!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).framesync={})}(this,function(e){"use strict";var r=0,n="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?function(e){return window.requestAnimationFrame(e)}:function(e){var n=Date.now(),t=Math.max(0,16.7-(n-r));r=n+t,setTimeout(function(){return e(r)},t)},p=function(){};"production"!==process.env.NODE_ENV&&(p=function(e,n){if(!e)throw new Error(n)});var t,o;(o=t=t||{}).Read="read",o.Update="update",o.Render="render",o.PostRender="postRender",o.FixedUpdate="fixedUpdate";function c(e){return u=e}function i(e){return v[e].process(s)}var a=1/60*1e3,d=!0,u=!1,f=!1,s={delta:0,timestamp:0},l=[t.Read,t.Update,t.Render,t.PostRender],m=l.reduce(function(e,n){var r=function(r){var c=[],i=[],a=0,d=!1,o=0,u=new WeakSet,f=new WeakSet,s={cancel:function(e){var n=i.indexOf(e);u.add(e),-1!==n&&i.splice(n,1)},process:function(e){var n,t;if(d=!0,c=(n=[i,c])[0],(i=n[1]).length=0,a=c.length)for(o=0;o<a;o++)(t=c[o])(e),!0!==f.has(t)||u.has(t)||(s.schedule(t),r(!0));d=!1},schedule:function(e,n,t){void 0===n&&(n=!1),void 0===t&&(t=!1),p("function"==typeof e,"Argument must be a function");var r=t&&d,o=r?c:i;u.delete(e),n&&f.add(e),-1===o.indexOf(e)&&(o.push(e),r&&(a=c.length))}};return s}(c);return e.sync[n]=function(e,n,t){return void 0===n&&(n=!1),void 0===t&&(t=!1),u||x(),r.schedule(e,n,t),e},e.cancelSync[n]=function(e){return r.cancel(e)},e.steps[n]=r,e},{steps:{},sync:{},cancelSync:{}}),v=m.steps,h=m.sync,y=m.cancelSync,w=function(e){u=!1,s.delta=d?a:Math.max(Math.min(e-s.timestamp,40),1),d||(a=s.delta),s.timestamp=e,f=!0,l.forEach(i),f=!1,u&&(d=!1,n(w))},x=function(){d=u=!0,f||n(w)};e.cancelSync=y,e.default=h,e.getFrameData=function(){return s},Object.defineProperty(e,"__esModule",{value:!0})});
