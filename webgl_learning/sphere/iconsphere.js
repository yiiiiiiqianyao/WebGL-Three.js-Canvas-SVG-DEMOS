!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).icomesh=e()}(this,function(){"use strict";return function(t=4,e=!1){if(t>10)throw new Error(`Max order is 10, but given ${t}.`);const n=(1+Math.sqrt(5))/2,o=10*Math.pow(4,t)+2,r=e?0===t?3:3*Math.pow(2,t)+9:0,i=new Float32Array(3*(o+r));i.set(Float32Array.of(-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1));let s=Uint16Array.of(0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,11,10,2,5,11,4,1,5,9,7,1,8,10,7,6,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,9,8,1,4,9,5,2,4,11,6,2,10,8,6,7),a=12;const f=t?new Map:null;function c(t,e){const n=Math.floor((t+e)*(t+e+1)/2+Math.min(t,e)),o=f.get(n);return void 0!==o?(f.delete(n),o):(f.set(n,a),i[3*a+0]=.5*(i[3*t+0]+i[3*e+0]),i[3*a+1]=.5*(i[3*t+1]+i[3*e+1]),i[3*a+2]=.5*(i[3*t+2]+i[3*e+2]),a++)}let l=s;const u=t>5?Uint32Array:Uint16Array;for(let e=0;e<t;e++){const t=l.length;s=new u(4*t);for(let e=0;e<t;e+=3){const t=l[e+0],n=l[e+1],o=l[e+2],r=c(t,n),i=c(n,o),a=c(o,t);let f=4*e;s[f++]=t,s[f++]=r,s[f++]=a,s[f++]=n,s[f++]=i,s[f++]=r,s[f++]=o,s[f++]=a,s[f++]=i,s[f++]=r,s[f++]=i,s[f++]=a}l=s}for(let t=0;t<3*o;t+=3){const e=i[t+0],n=i[t+1],o=i[t+2],r=1/Math.sqrt(e*e+n*n+o*o);i[t+0]*=r,i[t+1]*=r,i[t+2]*=r}if(!e)return{vertices:i,triangles:s};const h=new Float32Array(2*(o+r));for(let t=0;t<o;t++)h[2*t+0]=Math.atan2(i[3*t+2],i[3*t])/(2*Math.PI)+.5,h[2*t+1]=Math.asin(i[3*t+1])/Math.PI+.5;const M=new Map;function d(t,e,n,o){if(o){const e=M.get(t);if(void 0!==e)return e}return i[3*a+0]=i[3*t+0],i[3*a+1]=i[3*t+1],i[3*a+2]=i[3*t+2],h[2*a+0]=e,h[2*a+1]=n,o&&M.set(t,a),a++}for(let t=0;t<s.length;t+=3){const e=s[t+0],n=s[t+1],o=s[t+2];let r=h[2*e],i=h[2*n],a=h[2*o];const f=h[2*e+1],c=h[2*n+1],l=h[2*o+1];i-r>=.5&&1!==f&&(i-=1),a-i>.5&&(a-=1),(r>.5&&r-a>.5||1===r&&0===l)&&(r-=1),i>.5&&i-r>.5&&(i-=1),0===f||1===f?(r=(i+a)/2,f===i?h[2*e]=r:s[t+0]=d(e,r,f,!1)):0===c||1===c?(i=(r+a)/2,c===r?h[2*n]=i:s[t+1]=d(n,i,c,!1)):0!==l&&1!==l||(a=(r+i)/2,l===r?h[2*o]=a:s[t+2]=d(o,a,l,!1)),r!==h[2*e]&&0!==f&&1!==f&&(s[t+0]=d(e,r,f,!0)),i!==h[2*n]&&0!==c&&1!==c&&(s[t+1]=d(n,i,c,!0)),a!==h[2*o]&&0!==l&&1!==l&&(s[t+2]=d(o,a,l,!0))}return{vertices:i,triangles:s,uv:h}}});